<!DOCTYPE html>
{% load static %}
{% load dict_extras %}
{% load notifications_tags %}
<html lang="ja">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G08GZPEB1K"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-G08GZPEB1K');
    </script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Local Things Home</title>
    <meta name="description" content="{% block description %}Local Things„ÅØ„ÄÅÂ§ßÂàÜÁúå„ÅÆÂú∞Âüü„ÅÆ„Äå‰ΩïÊ∞ó„Å™„ÅÑ„ÇÇ„ÅÆ„Äç„ÇíÁ¥π‰ªã„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ
         „É≠„Éº„Ç´„É´„Éï„Éº„Éâ„ÇÑ„ÄÅ„É≠„Éº„Ç´„É´„Çπ„Éù„ÉÉ„Éà„ÄÅ„Éä„Ç§„Çπ„Å™„Åä„Çπ„Çπ„É°ÊÉÖÂ†±„Å™„Å©„ÄÇ
         Â§ßÂàÜ„ÅÆLocal„ÅåÂ•Ω„Åç„Å™‰∫∫„ÄÅËààÂë≥„Åå„ÅÇ„Çã‰∫∫„Å®„ÅßÂú∞Âüü„ÇíÁõõ„Çä‰∏ä„Åí„Å¶„ÅÑ„ÅèÂú∞ÂüüÂØÜÁùÄÂûãÂõΩÁî£SNS{% endblock %}"/>
    <!--  favicon  -->
    <link rel="icon" href="{% static 'favicon.ico' %}">
    <!-- PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Local Things">
    <link href="/static/apple-touch-icon.png" sizes="180x180" rel="apple-touch-icon">
    <meta name="theme-color" content="white">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    <!--  Google Search Console   -->
    <meta name="google-site-verification" content="pzDQnHiXAF6b76qLuGcsnt2Fg9p3PPVooCxmn4QJsKw" />
    <!--  Font Awesome      -->
    <script src="https://kit.fontawesome.com/893f850b11.js" crossorigin="anonymous"></script>
    <!--  Google Fonts      -->
    <link href="https://fonts.googleapis.com/css2?family=Baloo+Paaji+2&display=swap" rel="stylesheet">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <!--  Load CSS  -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>

<body>
    <header id="nav" class="mobile-nav-wrapper">
        <div class="mobile-nav-top-link">
            {% if user.is_authenticated %}
            <a href="{% url 'articles:users_detail' user.pk %}">
                <div class="mobile-profile-container">
                    <img src="{{ user.profile.image.url }}" class="profile-pic" alt="Avatar" loading="lazy">
                </div>
            </a>
            {% else %}
            <div class="mobile-profile-container">
                <i class="far fa-user-circle"></i>
            </div>
            {% endif %}
        </div>

        <div class="mobile-nav-top-link">
            <div class="mobile-nav-top-search">
                <form id="search" class="mobile-search" method="GET" action="{% url 'articles:list' %}">
                    <i class="fas fa-search"></i>
                    <input class="mobile-search-input" type="text" name="q" value="{{ request.GET.q }}" required/>
                    <label for="search"></label>
                </form>
            </div>
        </div>

        <div class="mobile-nav-top-link">
            <a href="{% url 'about' %}">
                <div class="mobile-wrapper_circle">
                    <h1 class="mobile-logo_1">L</h1><h1 class="mobile-logo_2">T</h1>
                </div>
            </a>
        </div>
    </header>

    <div class="container">
        <div class="left">
            <div class="left-icons-wrapper">
                {% include 'articles/snippet/left-nav.html' %}
            </div>
        </div>

        <div class="center" id="main">
            <div class="center-header">
                <div class="header-name">
                    <h3>„Éõ„Éº„É†</h3>
                </div>
                <div class="header-icon-circle">
                    <div class="header-icon">
                        <button id="darkModeToggle">
                            <i class="fas fa-star-and-crescent"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="hero" id="clouds">
                <div class="cloud top"></div>
                <div class="cloud mid_1"></div>
                <div class="cloud mid_2"></div>
                <div class="cloud mid_3"></div>
                <div class="cloud bottom"></div>
                <div class="bird">..</div>
                <div id="ufo">üõ∏</div>
                <div class="title_wrapper">
                    <h1>Oita Local things</h1>
                </div>
                <div class="sub_title">
                    What's ordinary to one person 
                    <br>might be extraordinary to another.
                </div>
                {% if user.is_authenticated %}
                <div class="global-footer"></div>
                {% else %}
                <div class="hero-btn">
                    <div class="hero-btn-word">„Åï„ÅÅ„ÄÅ„ÅØ„Åò„ÇÅ„Çà„ÅÜ</div>
                    <a href="{% url 'accounts:login' %}">Login</a>
                </div>
                {% endif %}
            </div>

            <div class="article-wrapper">
                <article class="following-feed">
                    {% for article in articles %}
                    <div class="following-feed-wrapper {% if forloop.counter|divisibleby:4 %}large-card{% endif %}">
                        <ul class="following-articles">
                            <li class="articles-item">
                                <a href="{% url 'articles:user-posts' article.author.username %}">
                                    <img src="{{ article.author.profile.image.url }}" alt="{{ article.author.username }} Avatar" loading="lazy">
                                </a>
                            </li>
                            <li class="articles-item">
                                <p>{{ article.author.username }}<small>„Éª{{ article.display_date }}</small></p>
                            </li>
                        </ul>
                        {% if article.images.all %}
                        <div class="articles-thumb">
                            <div class="swiper-container">
                                <div class="swiper-wrapper">
                                    {% for img in article.images.all %}
                                        {% if img.image%}
                                            <div class="swiper-slide">
                                                <img src="{{ img.image.url }}" loading="lazy" alt="{{ article.title }}"/>
                                            </div>
                                        {% else %}
                                            <div class="swiper-slide">
                                                <img src="/media/No-image.png" loading="lazy" alt="No image"/>
                                            </div>
                                        {% endif %}
                                    {% endfor %}
                                </div>

                                <div class="swiper-pagination"></div>

                                {% if article.images.count > 1 %}
                                    <div class="swiper-button-prev custom-swiper-button">
                                        <i class="fas fa-chevron-left"></i>
                                    </div>
                                    <div class="swiper-button-next custom-swiper-button">
                                        <i class="fas fa-chevron-right"></i>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                        {% endif %}
                        <div class="articles-caption-inline">
                            <span class="username">
                                <a href="{% url 'articles:user-posts' article.author.username %}">
                                    {{ article.author.username }}
                                </a>
                                {% with author_count=author_count_dict|get_item:article.author.id %}
                                    {% if author_count >= 20 %}
                                        <svg class="verified-badge" aria-label="Ë™çË®º„Éê„ÉÉ„Ç∏" fill="#0095f6" height="14" viewBox="0 0 40 40" width="14">
                                            <title>Ë™çË®ºÊ∏à„Åø</title>
                                            <path d="M19.998 3.094 14.638 0l-2.972 5.15H5.432v6.354L0 14.64 3.094 20 0 25.359l5.432 3.137v5.905h5.975L14.638 40l5.36-3.094L25.358 40l3.232-5.6h6.162v-6.01L40 25.359 36.905 20 40 14.641l-5.248-3.03v-6.46h-6.419L25.358 0l-5.36 3.094Zm7.415 11.225 2.254 2.287-11.43 11.5-6.835-6.93 2.244-2.258 4.587 4.581 9.18-9.18Z"></path>
                                        </svg>
                                    {% endif %}
                                {% endwith %}
                            </span>
                            <!-- „ÇØ„É™„ÉÉ„ÇØ„ÅßÂ±ïÈñã„Åô„Çã„ÉÜ„Ç≠„Çπ„ÉàÈÉ®ÂàÜ -->
                            <div class="snippet-text expandable" data-fulltext="{{ article.body|urlize|linebreaksbr|safe|escapejs }}" data-snippet="{{ article.snippet }}">
                                {{ article.snippet }}
                            </div>
                            <!-- „ÇØ„É™„ÉÉ„ÇØ„Åß detail „Éö„Éº„Ç∏„Å∏ÈÅ∑Áßª -->
                            <a href="{% url 'articles:detail' pk=article.pk %}" class="read-more">Á∂ö„Åç„ÇíË™≠„ÇÄ</a>
                        </div>
                        <div class="articles-icon">
                            <ul class="articles-icon-box">
                                <li class="icon-items {% for i in article.get_liked_user %}{% if i == request.user %}liked{% endif %}{% endfor %}">
                                    <div class="articles-icon-wrapper">
                                        <div class="articles-hover heart-circle">
                                            <i class="far fa-heart liked_heart"></i>
                                        </div>

                                        <div class="articles-sum">
                                            {% if article.total_likes %}
                                            <span>{{ article.total_likes }}</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                </li>

                                <li class="icon-items">
                                    <div class="articles-icon-wrapper">
                                        <div class="articles-hover">
                                            <i class="far fa-comment"></i>
                                        </div>

                                        <div class="articles-sum">
                                            {% if article.comments.count %}
                                            <span>{{ article.comments.count }}</span>
                                            {% endif %}
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                    {% empty %}
                    <div class="global-tag">
                        <h3>„ÅäÊé¢„Åó„ÅÆÊ§úÁ¥¢„Ç≠„Éº„ÉØ„Éº„Éâ„ÅØË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ</h3>
                    </div>
                    {% endfor %}
                </article>
            </div>
            {% include 'accounts/snippet/pagination.html' %}
            <div class="global-footer"></div>
        </div>


        <div class="right">
            <div class="right-wrapper">
                <div class="right-search">
                    <form id="right-search" class="form-search" method="GET" action="{% url 'articles:list' %}">
                        <i class="fas fa-search"></i>
                        <input class="search-input" type="text" name="q"
                            placeholder=" „Ç≠„Éº„ÉØ„Éº„ÉâÊ§úÁ¥¢" value="{{ request.GET.q }}" required/>
                    </form>
                </div>
                <div class="favorite-articles">
                    <div class="favorite-title">
                        <span>„Åä„Åô„Åô„ÇÅ</span>
                    </div>
                    {% for favorite in order_like_articles %}
                    <div class="favorite-wrapper">
                        <div class="favorite-items">
                            {% if favorite.category != None %}
                            <span class="favorite-category">
                                {{ favorite.category }}
                            </span>
                            {% endif %}
                            <a href="{% url 'articles:detail' pk=favorite.pk %}">
                                <span>{{ favorite.title | truncatechars_html:10 }}</span>
                            </a>
                        </div>
                        <div class="favorite-thumb">
                            {% if favorite.images.all %}
                                {% with first_image=favorite.images.all.first %}
                                    {% if first_image %}
                                        <img src="{{ first_image.image.url }}" loading="lazy" alt="{{ favorite.title }}"/>
                                    {% endif %}
                                {% endwith %}
                            {% else %}
                                <img src="/media/No-image.png" loading="lazy" alt="No image"/>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                    <div class="favorite-info">
                        <a href="{% url 'articles:ordered_by_likes' %}">
                            <h5>„Åï„Çâ„Å´Ë¶ã„Çã</h5>
                        </a>
                    </div>
                </div>
                {% if user.is_authenticated %}
                <div class="users">
                    <div class="favorite-title">
                        <span>Users</span>
                    </div>
                    {% for user in users %}
                    {% if request.user != user.user %}
                    <div class="users-wrapper">
                        <ul class="users-box">
                            <li class="users-items">
                                <a href="{% url 'accounts:profile_detail' user.user %}">
                                    <img src="{{ user.user.profile.image.url }}" alt="{{ user.user }}avatar">
                                </a>
                            </li>
                            <li class="users-items">
                                <span>{{ user.user }}</span>
                            </li>
                        </ul>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
                {% endif %}
                <div class="web-info">
                    <a href="{% url 'about' %}">
                        <span>Âà©Áî®Ë¶èÁ¥Ñ</span>
                    </a>
                    <a href="{% url 'privacy-policy' %}">
                        <span>„Éó„É©„Ç§„Éê„Ç∑„Éº„Éù„É™„Ç∑„Éº</span>
                    </a>
                    <div class="copyright">
                        <p>
                            <i class="far fa-copyright">2025 Local Things</i>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% if user.is_authenticated %}
    <div class="mobile-create-circle">
        <a href="{% url 'articles:create' %}">
            <i class="fa fa-plus"></i>
        </a>
    </div>
    {% endif %}
    <nav class="mobile-nav">
        <a href="#clouds" class="mobile-nav-link" id="scroll-top">
            <i class="fas fa-home mobile-nav-icon"></i>
        </a>
        <a href="{% url 'articles:gallery' %}" class="mobile-nav-link">
            <i class="far fa-compass mobile-nav-icon"></i>
        </a>
        {% notifications_unread as unread_count %}
        <a href="{% url 'my_notifications' %}" class="mobile-nav-link">
            <i class="far fa-bell mobile-nav-icon">
                {% if unread_count %}
                <div class="number">
                    <small class="live_notify_badge">{% if unread_count > 0 %}{{ unread_count }}{% endif %}</small>
                </div>
                {% endif %}
            </i>
        </a>
        <a href="{% url 'articles:book_mark_list' %}" class="mobile-nav-link">
            <i class="far fa-bookmark mobile-nav-icon"></i>
        </a>
        {% if user.is_authenticated %}
        <a href="{% url 'accounts:user_following' %}" class="mobile-nav-link">
            <i class="fas fa-user-check mobile-nav-icon"></i>
        </a>
        {% endif %}
    </nav>
    <script src="/static/js/scroll.js"></script>
    <script src="/static/js/mobile-create.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="/static/js/swiper-images.js"></script>
    <script src="/static/js/app.js"></script>
    <script src="/static/js/search-box.js"></script>
    <script src="/static/js/mobile-hover.js"></script>
    <script src="/static/js/mobile-search-box.js"></script>
    <script src="/static/js/scroll-top.js"></script>
    <script src="/static/js/ufo.js"></script>
    <script src="/static/js/darkmode.js"></script>
    <script src="/static/js/mobile-nav-scroll.js"></script>
    <script src="/static/js/fulltext.js"></script>
    </body>
</html>